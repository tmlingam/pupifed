<%-# Fedena
#Copyright 2010 Foradian Technologies Private Limited
#
#This product includes software developed at
#Project Fedena - http://www.projectfedena.org/
#
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.
#You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
#Unless required by applicable law or agreed to in writing,
#software distributed under the License is distributed on an
#"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#KIND, either express or implied.  See the License for the
#specific language governing permissions and limitations
#under the License. -%>


<% unless flash[:notice].nil? %> <p class="flash-msg"> <%= flash[:notice] %> </p> <% end %>

<div id="user_options">

  <% if @user.admin? %>
    <%= render :partial=>'metro_dashboard' %>

  <% elsif @user.student? or @user.parent?%>

    <div class="extender"></div>
    <div class="metro-area">
  <ul class="metro-shortcut clearfix unstyled">
    <li class="item">
      <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Profile.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>My Profile</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>student profile</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student", :action => "profile", :id => @student.id} %>
    </li>
        <li class="item">
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color yellow high'>
                <img class='attendance' src='/images/dashboard_buttons/Timetable.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>TimetableCentral<sup>TM</sup></h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>view timetable</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "timetable", :action => "student_view",:id=>@student.id} %>
          </li>
          <li class="item">
          	<%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color orange high'>
                <img class='attendance' src='/images/dashboard_buttons/Notice-Board.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Notice Board</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>see school announcements</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "news", :action => "index"}%>

          </li>

              <li class="item">
        <% unless @user.check_reminders == 0 %>
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color blue high'>
                <img class='attendance' src='/images/dashboard_buttons/messages.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Messages</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>inbox access</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "reminder", :action => "index"}%>

      <% else %>
        <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color blue high'>
                <img class='attendance' src='/images/dashboard_buttons/messages.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Messages</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>inbox access</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "reminder", :action => "index"}%>
      <% end %>

          </li>
          <li class="item">
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color dark-blue high'>
                <img class='attendance' src='/images/dashboard_buttons/exam-centre.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Exams/Reports</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>see exam schedule and reports</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student", :action => "reports",:id => @student.id}  %>
          </li>
          <li class="item">
      <a href='/calendar'>
        <div class="flip-container high" ontouchstart="this.classList.toggle('hover');">
          <div class="flipper">
            <div class="front">
              <div class="box bg-color brown high">
                <img class="calendar" src='/images/dashboard_buttons/Calendar-Glyph-small.png'>
              </div>
        <div class="overlay">
                <h4 class="header light">Organizer</h4>
	</div>
            </div>
            <div class="back">
              <div class="box bg-color blue high">
                <h4 class="header light">calendar</h4>
              </div>
            </div>
          </div>
        </div>
      </a>
          </li>
          <li class="item">
      <a href=''>
        <div class="flip-container high" ontouchstart="this.classList.toggle('hover');">
          <div class="flipper">
            <div class="front">
              <div class="box bg-color dark-grey high">
                <img class="virtual" src='/images/dashboard_buttons/Group-Therapy.png'>
                <div class="overlay">
                	<h4 class="header light">Group Therapy</h4>
				</div>
              </div>
            </div>
            <div class="back">
              <div class="box bg-color blue high">
                <h4 class="header light">closed group functions</h4>
              </div>
            </div>
          </div>
        </div>
      </a>
          </li>
          <li class="item">
          <a href='/courses'>
        <div class="flip-container high" ontouchstart="this.classList.toggle('hover');">
          <div class="flipper">
            <div class="front">
              <div class="box bg-color dark-blue high">
                <img class="virtual" src='/images/dashboard_buttons/Comp-Glyph.png'>
                <div class="overlay">
                	<h4 class="header light">Conference</h4>
				</div>
              </div>
            </div>
            <div class="back">
              <div class="box bg-color blue high">
                <h4 class="header light">interact for productivity</h4>
              </div>
            </div>
          </div>
        </div>
      </a>
    </li>
        </ul>
    </div>
          
          <% else %>

    <div class="extender"></div>
    <div class="metro-area">
  <ul class="metro-shortcut clearfix unstyled">
          <li class="item">
          <% if @config.include?('HR') %>
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Profile.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>My Profile</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>see employee profile</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "employee", :action => "profile",:id => @employee.id} unless @employee.nil?%>
        <% end  %>
          </li>
          <li class="item">
              <% if permitted_to? :add,:news %>
          	<%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color orange high'>
                <img class='attendance' src='/images/dashboard_buttons/Notice-Board.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Notice Board</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>view and add news to notice board</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "news", :action => "index"} %>
            <% else %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color orange high'>
                <img class='attendance' src='/images/dashboard_buttons/Notice-Board.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Notice Board</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>view and add news to notice board</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "news", :action => "index"} %>
            <%end%>
          </li>
                        
          <li class="item">
              <% if permitted_to? :index, :student%>
          	<%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color blue high'>
                <img class='attendance' src='/images/dashboard_buttons/Students-details-Glyph.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Search Students</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>search from current and alumni</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student", :action => "index"} %>
            <%end%>
          </li>
              <li class="item">
                <% if permitted_to? :index, :user %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>User</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>Text Here</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "user", :action => "index"} %>
            <%end%>
          </li>
          <li class="item">
                <% unless @user.check_reminders == 0 %>
          	<%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color blue high'>
                <img class='attendance' src='/images/dashboard_buttons/messages.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Messages</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>see inbox </h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "reminder", :action => "index"} %>
                <% else %>
                <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color blue high'>
                <img class='attendance' src='/images/dashboard_buttons/messages.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Messages</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>see inbox </h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "reminder", :action => "index"} %>
        <% end %>
          </li>
          
              <li class="item">
                <% if permitted_to? :leave_management, :employee %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Leave</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>apply for leaves</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "employee", :action => "leave_management"} %>
            <%else%>
                  <% if @config.include?('HR') %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Leaves</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>Text Here</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "employee_attendance", :action => "leaves",:id => @employee.id} unless @employee.nil?%>
        <%end%>
    <%end%>

          </li>
          
          <li class="item">

            <% if permitted_to? :admission1, :student %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Admission-Glyph.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Admission</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>add students here</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student", :action => "admission1"} %>
            <%end%>
          </li>

        


    <% if @user.employee? %>
          <li class="item">
      <% @employee_subjects= @user.employee_record.subject_ids  %>
      <% if @employee_subjects.empty?%>

        <% if permitted_to? :index, :student_attendance or  permitted_to? :index, :attendances and @employee_subjects.present? or @user.privileges.map{|p| p.name}.include?("StudentAttendanceView") or @user.privileges.map{|p| p.name}.include?("StudentAttendanceRegister") %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Attendance</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage student attendance</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student_attendance", :action => "index"} %>
        <%end%>
          </li>
              <li class="item">


        <% if permitted_to? :index, :exam and (@user.privileges.map{|p| p.name}.include?("ExaminationControl") or @user.privileges.map{|p| p.name}.include?("EnterResults") or @user.privileges.map{|p| p.name}.include?("ViewResults")) %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color dark-blue high'>
                <img class='attendance' src='/images/dashboard_buttons/exam-centre.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Exams/Reports</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage exams and view reports</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "exam", :action => "index"} %>
        <% end %>
          </li>
          
          </li>

          <li class="item">
      <% else %>
        <% @attendance_type = Configuration.find_by_config_key('StudentAttendanceType') %>
        <% unless @attendance_type.config_value == 'Daily' %>
            <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Student Attendance</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage student attendance</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student_attendance", :action => "index"} %>
        <% else %>
            <% if permitted_to? :index, :student_attendance or  permitted_to? :index, :attendances %>
              <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/Attendance.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Student Attendance</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage student attendance</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "student_attendance", :action => "index"} %>
            <%end%>
        <% end %>
          </li>
          <li class="item">
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color green high'>
                <img class='attendance' src='/images/dashboard_buttons/exam-centre.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Exams/Reports</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage exams and view reports</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "exam", :action => "index"} %>
      <% end  %>
    <% end %>
          </li>
              <li class="item">

    <% if permitted_to? :index, :timetable %>
        <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color yellow high'>
                <img class='attendance' src='/images/dashboard_buttons/Timetable.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>TimetableCentral<sup>TM</sup></h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage class timetables</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "timetable", :action => "index"} %>
    <%end%>
          </li>
          <li class="item">
    <% if permitted_to? :index, :configuration %>
        <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color dark-grey high'>
                <img class='attendance' src='/images/dashboard_buttons/Settings-Glyph.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Settings</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>configure system</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "configuration", :action => "index"} %>
    <% end %>
          </li>
              <li class="item">
    <% if @config.include?('HR') %>
      <% if permitted_to? :hr,:employee %>
          <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color skin high'>
                <img class='attendance' src='/images/dashboard_buttons/HR.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>School Mgmt.</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>human resource department</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "employee", :action => "hr"} %>
      <% end %>
    <% end %>
          </li>
          <li class="item">
    <% if permitted_to? :index,:finance %>
        <%= link_to "<div class='flip-container high' ontouchstart='this.classList.toggle('hover');'>
          <div class='flipper'>
            <div class='front'>
              <div class='box bg-color purple high'>
                <img class='attendance' src='/images/dashboard_buttons/Finance-Glyph.png'>
              </div>
        <div class='overlay'>
                <h4 class='header light'>Money Matters</h4>
         </div>
            </div>
            <div class='back'>
              <div class='box bg-color blue high'>
                <h4 class='header light'>manage your finances....</h4>
              </div>
            </div>
          </div>
        </div>", {:controller => "finance", :action => "index"} %>
    <% end %>
          </li>
          </ul>
    </div>

  <% end %>
  </div>


<% cache News.cache_fragment_name do%>
  <%= render :partial=>'news_bar' %>
<% end %>
<div id="option_description"> </div>

<script type="text/javascript">
  $$('#user_options .button-box').each(function(ele, index){
    if(index%5 == 0){
      ele.addClassName("left-button");
    }
  });
</script>
